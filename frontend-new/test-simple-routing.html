<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç®€å•è·¯ç”±æµ‹è¯• - æ ¹è·¯å¾„é‡å®šå‘</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 40px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 30px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .test-section { margin: 20px 0; padding: 20px; border: 1px solid #e0e0e0; border-radius: 5px; }
        .test-button { padding: 12px 24px; margin: 8px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; }
        .test-button:hover { background: #0056b3; }
        .result { margin: 15px 0; padding: 15px; background: #f8f9fa; border-left: 4px solid #007bff; border-radius: 3px; }
        .success { border-left-color: #28a745; background: #d4edda; }
        .warning { border-left-color: #ffc107; background: #fff3cd; }
        .info { border-left-color: #17a2b8; background: #d1ecf1; }
        .current-status { background: #e7f3ff; border-left: 4px solid #28a745; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ æ ¹è·¯å¾„é‡å®šå‘æµ‹è¯•</h1>
        <p>è¿™ä¸ªé¡µé¢æµ‹è¯•Vue Routerçš„æ ¹è·¯å¾„é‡å®šå‘è¡Œä¸º</p>
        
        <div class="test-section">
            <h2>ğŸ“ å½“å‰çŠ¶æ€</h2>
            <div class="result current-status">
                <strong>å½“å‰URL:</strong> <span id="current-url">åŠ è½½ä¸­...</span><br>
                <strong>å½“å‰è·¯å¾„:</strong> <span id="current-path">åŠ è½½ä¸­...</span><br>
                <strong>è®¤è¯çŠ¶æ€:</strong> <span id="auth-status">æ£€æŸ¥ä¸­...</span>
            </div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ§ª è·¯ç”±æµ‹è¯•</h2>
            <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®æµ‹è¯•ä¸åŒçš„è·¯ç”±è¡Œä¸ºï¼š</p>
            
            <button class="test-button" onclick="testRootPath()">æµ‹è¯•æ ¹è·¯å¾„ /</button>
            <button class="test-button" onclick="testLoginPath()">æµ‹è¯•ç™»å½•é¡µ /login</button>
            <button class="test-button" onclick="testDashboardPath()">æµ‹è¯•ä»ªè¡¨æ¿ /dashboard</button>
            <button class="test-button" onclick="clearAuth()">æ¸…é™¤è®¤è¯çŠ¶æ€</button>
            <button class="test-button" onclick="setAuth()">è®¾ç½®è®¤è¯çŠ¶æ€</button>
            
            <div id="test-results"></div>
        </div>
        
        <div class="test-section">
            <h2>ğŸ“‹ é¢„æœŸè¡Œä¸º</h2>
            <ul>
                <li><strong>è®¿é—® /</strong> â†’ åº”è¯¥é‡å®šå‘åˆ° /login</li>
                <li><strong>è®¿é—® /login</strong> â†’ æœªè®¤è¯ç”¨æˆ·æ­£å¸¸è®¿é—®ï¼Œå·²è®¤è¯ç”¨æˆ·é‡å®šå‘åˆ° /dashboard</li>
                <li><strong>è®¿é—® /dashboard</strong> â†’ éœ€è¦è®¤è¯ï¼Œæœªè®¤è¯ç”¨æˆ·é‡å®šå‘åˆ° /login</li>
            </ul>
        </div>
        
        <div class="test-section">
            <h2>ğŸ” æµ‹è¯•è¯´æ˜</h2>
            <p>è¿™ä¸ªæµ‹è¯•æ¨¡æ‹Ÿäº†Vue Routerçš„è¡Œä¸ºï¼Œå¸®åŠ©éªŒè¯è·¯ç”±é…ç½®æ˜¯å¦æ­£ç¡®ã€‚</p>
            <p><strong>é‡è¦:</strong> å®é™…çš„Vueåº”ç”¨ä¸­çš„é‡å®šå‘æ˜¯åœ¨å®¢æˆ·ç«¯JavaScriptä¸­å¤„ç†çš„ï¼ŒæœåŠ¡å™¨ç«¯æ— æ³•æ„ŸçŸ¥ã€‚</p>
        </div>
    </div>

    <script>
        // æ¨¡æ‹ŸVue Routerçš„è¡Œä¸º
        let currentPath = '/';
        let isAuthenticated = false;
        
        // åˆå§‹åŒ–
        function init() {
            updateCurrentStatus();
            checkAuthFromStorage();
        }
        
        // æ›´æ–°å½“å‰çŠ¶æ€æ˜¾ç¤º
        function updateCurrentStatus() {
            document.getElementById('current-url').textContent = window.location.href;
            document.getElementById('current-path').textContent = currentPath;
            document.getElementById('auth-status').textContent = isAuthenticated ? 'âœ… å·²è®¤è¯' : 'âŒ æœªè®¤è¯';
        }
        
        // æ£€æŸ¥localStorageä¸­çš„è®¤è¯çŠ¶æ€
        function checkAuthFromStorage() {
            const token = localStorage.getItem('token');
            isAuthenticated = !!token;
            updateCurrentStatus();
        }
        
        // æµ‹è¯•æ ¹è·¯å¾„
        function testRootPath() {
            addTestResult('æµ‹è¯•æ ¹è·¯å¾„ /', 'info');
            addTestResult('å°è¯•è®¿é—®æ ¹è·¯å¾„...', 'info');
            
            // æ¨¡æ‹Ÿæ ¹è·¯å¾„é‡å®šå‘é€»è¾‘
            setTimeout(() => {
                addTestResult('ğŸ”„ æ ¹è·¯å¾„ / é‡å®šå‘åˆ° /login', 'success');
                currentPath = '/login';
                updateCurrentStatus();
            }, 500);
        }
        
        // æµ‹è¯•ç™»å½•é¡µ
        function testLoginPath() {
            addTestResult('æµ‹è¯•ç™»å½•é¡µ /login', 'info');
            
            if (isAuthenticated) {
                addTestResult('ğŸ”„ å·²è®¤è¯ç”¨æˆ·è®¿é—® /loginï¼Œé‡å®šå‘åˆ° /dashboard', 'warning');
                currentPath = '/dashboard';
            } else {
                addTestResult('âœ… æœªè®¤è¯ç”¨æˆ·æ­£å¸¸è®¿é—® /login', 'success');
                currentPath = '/login';
            }
            
            updateCurrentStatus();
        }
        
        // æµ‹è¯•ä»ªè¡¨æ¿
        function testDashboardPath() {
            addTestResult('æµ‹è¯•ä»ªè¡¨æ¿ /dashboard', 'info');
            
            if (isAuthenticated) {
                addTestResult('âœ… å·²è®¤è¯ç”¨æˆ·æ­£å¸¸è®¿é—® /dashboard', 'success');
                currentPath = '/dashboard';
            } else {
                addTestResult('ğŸ”„ æœªè®¤è¯ç”¨æˆ·è®¿é—® /dashboardï¼Œé‡å®šå‘åˆ° /login', 'warning');
                currentPath = '/login';
            }
            
            updateCurrentStatus();
        }
        
        // è®¤è¯çŠ¶æ€ç®¡ç†
        function clearAuth() {
            localStorage.removeItem('token');
            isAuthenticated = false;
            updateCurrentStatus();
            addTestResult('æ¸…é™¤è®¤è¯çŠ¶æ€æˆåŠŸ', 'success');
        }
        
        function setAuth() {
            localStorage.setItem('token', 'test-token-' + Date.now());
            isAuthenticated = true;
            updateCurrentStatus();
            addTestResult('è®¾ç½®è®¤è¯çŠ¶æ€æˆåŠŸ', 'success');
        }
        
        // æ·»åŠ æµ‹è¯•ç»“æœ
        function addTestResult(message, type = 'info') {
            const resultsDiv = document.getElementById('test-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = `
                <strong>${message}</strong><br>
                <small>æ—¶é—´: ${new Date().toLocaleTimeString()}</small>
            `;
            resultsDiv.appendChild(resultDiv);
            
            // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
            resultsDiv.scrollTop = resultsDiv.scrollHeight;
        }
        
        // é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
        window.addEventListener('load', init);
        
        // ç›‘å¬localStorageå˜åŒ–
        window.addEventListener('storage', function(e) {
            if (e.key === 'token') {
                checkAuthFromStorage();
            }
        });
    </script>
</body>
</html>
