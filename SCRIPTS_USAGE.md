# è„šæœ¬ä½¿ç”¨æ€»ç»“

## ğŸ“‹ è„šæœ¬æ€»è§ˆ

æœ¬é¡¹ç›®åŒ…å«å¤šä¸ªè„šæœ¬æ–‡ä»¶ï¼Œæ¯ä¸ªè„šæœ¬éƒ½æœ‰ç‰¹å®šçš„ç”¨é€”ã€‚ä»¥ä¸‹æ˜¯æ‰€æœ‰è„šæœ¬çš„è¯¦ç»†è¯´æ˜å’Œä½¿ç”¨æ–¹æ³•ã€‚

## ğŸš€ éƒ¨ç½²è„šæœ¬

### 1. `deploy.sh` - ä¸»éƒ¨ç½²è„šæœ¬

**ç”¨é€”**: å®Œæ•´çš„ç³»ç»Ÿéƒ¨ç½²å’Œç®¡ç†è„šæœ¬

**ä¸»è¦åŠŸèƒ½**:
- é¦–æ¬¡éƒ¨ç½² (`first-deploy`)
- å¿«é€Ÿéƒ¨ç½² (`quick-deploy`)
- æ•°æ®åº“ç®¡ç† (å¯¼å‡ºã€å¯¼å…¥ã€å¤‡ä»½ã€ä¿®å¤)
- æœåŠ¡ç®¡ç† (å¯åŠ¨ã€åœæ­¢ã€é‡å¯)
- å¥åº·æ£€æŸ¥å’ŒçŠ¶æ€ç›‘æ§

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æŸ¥çœ‹å¸®åŠ©
./deploy.sh help

# é¦–æ¬¡éƒ¨ç½²
./deploy.sh first-deploy

# å¿«é€Ÿéƒ¨ç½²
./deploy.sh quick-deploy

# æ•°æ®åº“æ“ä½œ
./deploy.sh export-db      # å¯¼å‡ºæ•°æ®åº“
./deploy.sh import-db      # å¯¼å…¥æ•°æ®åº“
./deploy.sh backup-db      # å¤‡ä»½æ•°æ®åº“
./deploy.sh fix-schema     # ä¿®å¤æ•°æ®åº“ç»“æ„

# æœåŠ¡ç®¡ç†
./deploy.sh start          # å¯åŠ¨æœåŠ¡
./deploy.sh stop           # åœæ­¢æœåŠ¡
./deploy.sh restart        # é‡å¯æœåŠ¡
./deploy.sh status         # æŸ¥çœ‹çŠ¶æ€
./deploy.sh health         # å¥åº·æ£€æŸ¥
```

### 2. `quick_deploy.sh` - å¿«é€Ÿéƒ¨ç½²è„šæœ¬

**ç”¨é€”**: æ–°ç¯å¢ƒçš„ä¸€é”®å¿«é€Ÿéƒ¨ç½²

**ç‰¹ç‚¹**:
- è‡ªåŠ¨å®‰è£…ç³»ç»Ÿä¾èµ–
- è‡ªåŠ¨é…ç½®æ•°æ®åº“
- è‡ªåŠ¨ç”ŸæˆSSLè¯ä¹¦
- è‡ªåŠ¨éƒ¨ç½²å‰åç«¯
- è‡ªåŠ¨é…ç½®Nginx

**ä½¿ç”¨æ–¹æ³•**:
```bash
chmod +x quick_deploy.sh
./quick_deploy.sh
```

**é€‚ç”¨åœºæ™¯**:
- æ–°æœåŠ¡å™¨éƒ¨ç½²
- å¼€å‘ç¯å¢ƒæ­å»º
- æµ‹è¯•ç¯å¢ƒéƒ¨ç½²

### 3. `start-all-services.sh` - æœåŠ¡å¯åŠ¨è„šæœ¬

**ç”¨é€”**: å¯åŠ¨æ‰€æœ‰ç³»ç»ŸæœåŠ¡

**å¯åŠ¨çš„æœåŠ¡**:
- PostgreSQL æ•°æ®åº“
- Redis ç¼“å­˜
- åç«¯APIæœåŠ¡
- Nginx WebæœåŠ¡å™¨

**ä½¿ç”¨æ–¹æ³•**:
```bash
chmod +x start-all-services.sh
./start-all-services.sh
```

**é€‚ç”¨åœºæ™¯**:
- ç³»ç»Ÿé‡å¯åå¯åŠ¨æœåŠ¡
- æœåŠ¡å¼‚å¸¸åé‡æ–°å¯åŠ¨
- æ—¥å¸¸æœåŠ¡ç®¡ç†

## ğŸ” å®‰å…¨è„šæœ¬

### 4. `generate_ssl_cert.sh` - SSLè¯ä¹¦ç”Ÿæˆè„šæœ¬

**ç”¨é€”**: ç”Ÿæˆè‡ªç­¾åSSLè¯ä¹¦

**åŠŸèƒ½**:
- è‡ªåŠ¨åˆ›å»ºSSLç›®å½•
- ç”ŸæˆRSAå¯†é’¥å¯¹
- è®¾ç½®æ­£ç¡®çš„æ–‡ä»¶æƒé™
- æ˜¾ç¤ºè¯ä¹¦ä¿¡æ¯

**ä½¿ç”¨æ–¹æ³•**:
```bash
sudo ./generate_ssl_cert.sh
```

**æ³¨æ„äº‹é¡¹**:
- éœ€è¦rootæƒé™è¿è¡Œ
- ç”Ÿæˆçš„æ˜¯è‡ªç­¾åè¯ä¹¦
- æµè§ˆå™¨ä¼šæ˜¾ç¤ºå®‰å…¨è­¦å‘Šï¼ˆæ­£å¸¸ç°è±¡ï¼‰

## ğŸ—„ï¸ æ•°æ®åº“è„šæœ¬

### 5. `init_database.sql` - æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬

**ç”¨é€”**: åˆ›å»ºå®Œæ•´çš„æ•°æ®åº“ç»“æ„

**åŒ…å«å†…å®¹**:
- 6ä¸ªæ ¸å¿ƒè¡¨ (tenants, users, projects, categories, suppliers, transactions)
- å®Œæ•´çš„å­—æ®µå®šä¹‰
- ç´¢å¼•å’Œçº¦æŸ
- åˆå§‹æ•°æ®
- ç”¨æˆ·æƒé™è®¾ç½®

**ä½¿ç”¨æ–¹æ³•**:
```bash
sudo -u postgres psql -f init_database.sql
```

**é€‚ç”¨åœºæ™¯**:
- æ–°æ•°æ®åº“åˆå§‹åŒ–
- æ•°æ®åº“ç»“æ„é‡å»º
- å¼€å‘ç¯å¢ƒæ­å»º

### 6. `database_initial.sql.gz` - åˆå§‹æ•°æ®åº“å¯¼å‡º

**ç”¨é€”**: åŒ…å«åŸºç¡€è¡¨ç»“æ„å’Œæ•°æ®çš„æ•°æ®åº“å¯¼å‡ºæ–‡ä»¶

**ç‰¹ç‚¹**:
- å‹ç¼©æ ¼å¼ï¼ŒèŠ‚çœç©ºé—´
- åŒ…å«å®Œæ•´çš„æ•°æ®åº“çŠ¶æ€
- å¯ç”¨äºå¿«é€Ÿæ¢å¤

**ä½¿ç”¨æ–¹æ³•**:
```bash
# è§£å‹å¹¶å¯¼å…¥
gunzip -c database_initial.sql.gz | sudo -u postgres psql
```

## âš™ï¸ é…ç½®æ–‡ä»¶

### 7. `nginx-site.conf` - Nginxç«™ç‚¹é…ç½®

**ç”¨é€”**: NginxæœåŠ¡å™¨é…ç½®

**é…ç½®å†…å®¹**:
- HTTPSæ”¯æŒ (443ç«¯å£)
- HTTPé‡å®šå‘åˆ°HTTPS
- å‰ç«¯é™æ€æ–‡ä»¶æœåŠ¡
- åç«¯APIä»£ç†
- SSLå®‰å…¨é…ç½®
- æ—¥å¿—é…ç½®

**ä½¿ç”¨æ–¹æ³•**:
```bash
sudo cp nginx-site.conf /etc/nginx/sites-available/fince-project
sudo ln -sf /etc/nginx/sites-available/fince-project /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx
```

### 8. `fince-backend.service` - ç³»ç»ŸæœåŠ¡æ–‡ä»¶

**ç”¨é€”**: åç«¯APIæœåŠ¡çš„systemdé…ç½®

**é…ç½®å†…å®¹**:
- æœåŠ¡æè¿°å’Œä¾èµ–
- å¯åŠ¨å‘½ä»¤å’Œå‚æ•°
- è‡ªåŠ¨é‡å¯ç­–ç•¥
- ç”¨æˆ·æƒé™è®¾ç½®

**ä½¿ç”¨æ–¹æ³•**:
```bash
sudo cp fince-backend.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable fince-backend.service
sudo systemctl start fince-backend.service
```

## ğŸ“š æ–‡æ¡£æ–‡ä»¶

### 9. `DEPLOYMENT_GUIDE.md` - å®Œæ•´éƒ¨ç½²æŒ‡å—

**ç”¨é€”**: è¯¦ç»†çš„éƒ¨ç½²è¯´æ˜æ–‡æ¡£

**å†…å®¹**:
- ç³»ç»Ÿæ¶æ„è¯´æ˜
- åˆ†æ­¥éƒ¨ç½²æŒ‡å—
- è„šæœ¬ä½¿ç”¨è¯´æ˜
- æ•…éšœæ’é™¤æŒ‡å—
- æœ€ä½³å®è·µå»ºè®®

### 10. `README.md` - é¡¹ç›®è¯´æ˜æ–‡æ¡£

**ç”¨é€”**: é¡¹ç›®æ¦‚è¿°å’Œå¿«é€Ÿå¼€å§‹æŒ‡å—

**å†…å®¹**:
- é¡¹ç›®ä»‹ç»
- å¿«é€Ÿéƒ¨ç½²æ–¹æ³•
- è„šæœ¬è¯´æ˜è¡¨æ ¼
- è®¿é—®åœ°å€
- æŠ€æœ¯æ”¯æŒä¿¡æ¯

## ğŸ”„ è„šæœ¬æ‰§è¡Œé¡ºåº

### æ–°ç¯å¢ƒéƒ¨ç½²æµç¨‹

```bash
# 1. å…‹éš†é¡¹ç›®
git clone <repository-url>
cd project-fince

# 2. å¿«é€Ÿéƒ¨ç½²ï¼ˆæ¨èï¼‰
chmod +x quick_deploy.sh
./quick_deploy.sh

# 3. å¯åŠ¨æœåŠ¡
./start-all-services.sh
```

### ç°æœ‰ç¯å¢ƒæ›´æ–°æµç¨‹

```bash
# 1. æ›´æ–°ä»£ç 
git pull origin master

# 2. é‡æ–°éƒ¨ç½²
./deploy.sh quick-deploy

# 3. é‡å¯æœåŠ¡
./deploy.sh restart
```

### æ•°æ®åº“è¿ç§»æµç¨‹

```bash
# 1. å¯¼å‡ºå½“å‰æ•°æ®åº“
./deploy.sh export-db

# 2. è¿ç§»åˆ°æ–°ç¯å¢ƒ
./deploy.sh import-db

# 3. éªŒè¯æ•°æ®
./deploy.sh health
```

## ğŸš¨ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

1. **è„šæœ¬æƒé™é—®é¢˜**
   ```bash
   chmod +x *.sh
   ```

2. **SSLè¯ä¹¦é—®é¢˜**
   ```bash
   sudo ./generate_ssl_cert.sh
   sudo systemctl restart nginx
   ```

3. **æ•°æ®åº“è¿æ¥é—®é¢˜**
   ```bash
   sudo systemctl status postgresql
   ./deploy.sh fix-schema
   ```

4. **æœåŠ¡å¯åŠ¨å¤±è´¥**
   ```bash
   ./deploy.sh status
   sudo journalctl -u fince-backend.service -f
   ```

## ğŸ’¡ æœ€ä½³å®è·µ

1. **é¦–æ¬¡éƒ¨ç½²**: ä½¿ç”¨ `quick_deploy.sh`
2. **æ—¥å¸¸ç®¡ç†**: ä½¿ç”¨ `deploy.sh` çš„å„ç§å‘½ä»¤
3. **æœåŠ¡å¯åŠ¨**: ä½¿ç”¨ `start-all-services.sh`
4. **æ•°æ®åº“å¤‡ä»½**: å®šæœŸä½¿ç”¨ `./deploy.sh backup-db`
5. **SSLè¯ä¹¦**: æ¯å¹´æ›´æ–°ä¸€æ¬¡è¯ä¹¦

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æŒ‰ä»¥ä¸‹é¡ºåºæ£€æŸ¥ï¼š

1. æŸ¥çœ‹è„šæœ¬å¸®åŠ©: `./deploy.sh help`
2. æ£€æŸ¥æœåŠ¡çŠ¶æ€: `./deploy.sh status`
3. æ‰§è¡Œå¥åº·æ£€æŸ¥: `./deploy.sh health`
4. æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
5. å‚è€ƒéƒ¨ç½²æŒ‡å—æ–‡æ¡£

---

**æ³¨æ„**: æ‰€æœ‰è„šæœ¬éƒ½ç»è¿‡æµ‹è¯•ï¼Œä½†å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨å‰å…ˆåœ¨æµ‹è¯•ç¯å¢ƒéªŒè¯ã€‚
